  </main>

  <!-- 전역 로딩 오버레이 -->
  <div id="globalLoadingOverlay" class="loading-overlay" style="display: none;">
    <div class="loading-content">
      <div class="spinner-border text-primary" role="status" style="width: 2.5rem; height: 2.5rem;">
        <span class="visually-hidden">로딩중...</span>
      </div>
      <div class="loading-text mt-2">조회중...</div>
    </div>
  </div>

  <footer class="bg-light py-3 mt-5">
    <div class="container text-center text-muted">
      <small>&copy; 2024-2026 N2골프 (NH투자증권 골프동호회). All rights reserved.</small>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="/js/main.js"></script>
  <script src="/js/table-sort.js"></script>
  <!-- Vercel Analytics -->
  <script>
    window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
  </script>
  <script defer src="/_vercel/insights/script.js"></script>
  <!-- CSRF 토큰을 fetch 요청에 자동 포함 -->
  <script>
    (function() {
      const csrfToken = document.querySelector('meta[name="csrf-token"]')?.content;
      if (csrfToken) {
        const originalFetch = window.fetch;
        window.fetch = function(url, options = {}) {
          if (['POST', 'PUT', 'DELETE'].includes((options.method || 'GET').toUpperCase())) {
            options.headers = options.headers || {};
            if (options.headers instanceof Headers) {
              options.headers.set('X-CSRF-Token', csrfToken);
            } else {
              options.headers['X-CSRF-Token'] = csrfToken;
            }
          }
          return originalFetch(url, options);
        };
      }
    })();
  </script>
  <!-- Service Worker 등록 -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(reg => console.log('Service Worker 등록 완료'))
          .catch(err => console.log('Service Worker 등록 실패:', err));
      });
    }
  </script>
  <!-- 개인 통계 롤링 카드 -->
  <script>
    (function() {
      const carousel = document.getElementById('statsCarousel');
      const indicators = document.querySelectorAll('.stats-indicator');
      if (!carousel || indicators.length === 0) return;

      let currentIndex = 0;
      const totalSlides = 4;
      const intervalTime = 4000;

      function goToSlide(index) {
        currentIndex = index;
        carousel.style.transform = `translateX(-${index * 25}%)`;
        indicators.forEach((ind, i) => {
          ind.classList.toggle('active', i === index);
        });
      }

      function nextSlide() {
        goToSlide((currentIndex + 1) % totalSlides);
      }

      // 자동 롤링
      let autoSlide = setInterval(nextSlide, intervalTime);

      // 인디케이터 클릭
      indicators.forEach((ind, i) => {
        ind.addEventListener('click', () => {
          clearInterval(autoSlide);
          goToSlide(i);
          autoSlide = setInterval(nextSlide, intervalTime);
        });
      });

      // 터치 스와이프 지원
      let touchStartX = 0;
      let touchEndX = 0;

      carousel.addEventListener('touchstart', (e) => {
        touchStartX = e.changedTouches[0].screenX;
      }, { passive: true });

      carousel.addEventListener('touchend', (e) => {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
      }, { passive: true });

      function handleSwipe() {
        const diff = touchStartX - touchEndX;
        if (Math.abs(diff) > 50) {
          clearInterval(autoSlide);
          if (diff > 0) {
            goToSlide((currentIndex + 1) % totalSlides);
          } else {
            goToSlide((currentIndex - 1 + totalSlides) % totalSlides);
          }
          autoSlide = setInterval(nextSlide, intervalTime);
        }
      }
    })();
  </script>
  <!-- 전역 로딩 인디케이터 스크립트 -->
  <script>
    (function() {
      const loadingOverlay = document.getElementById('globalLoadingOverlay');
      if (!loadingOverlay) return;

      let isLoading = false;
      let loadingTimeout;
      let showLoadingTimer;

      // 로딩 표시 함수
      function showLoading() {
        if (isLoading) return;
        isLoading = true;
        loadingOverlay.style.display = 'flex';
        // 5초 후 자동 숨김 (무한 로딩 방지)
        clearTimeout(loadingTimeout);
        loadingTimeout = setTimeout(hideLoading, 5000);
      }

      // 로딩 숨김 함수
      function hideLoading() {
        isLoading = false;
        loadingOverlay.style.display = 'none';
        clearTimeout(loadingTimeout);
        clearTimeout(showLoadingTimer);
      }

      // 지연 로딩 표시 (100ms 후 표시 - 빠른 페이지면 깜빡임 방지)
      function scheduleShowLoading() {
        if (isLoading) return;
        clearTimeout(showLoadingTimer);
        showLoadingTimer = setTimeout(showLoading, 100);
      }

      // 페이지 이동 감지 - 통합 클릭 이벤트
      document.addEventListener('click', function(e) {
        // 이미 로딩 예약/진행 중이면 무시
        if (isLoading) return;

        // 링크 클릭 확인
        const linkTarget = e.target.closest('a');
        if (linkTarget) {
          const href = linkTarget.getAttribute('href');

          // 무시할 링크 패턴
          if (!href ||
              href === '' ||
              href.startsWith('#') ||
              href.startsWith('javascript:') ||
              href.startsWith('tel:') ||
              href.startsWith('mailto:') ||
              linkTarget.getAttribute('target') === '_blank' ||
              linkTarget.hasAttribute('data-bs-toggle') ||
              linkTarget.classList.contains('no-loading')) {
            return;
          }

          // 페이지 이동 링크만 로딩 표시
          if (href.startsWith('/') || href.startsWith(window.location.origin)) {
            scheduleShowLoading();
            return;
          }
        }

        // onclick으로 location.href 변경하는 경우
        const onclickTarget = e.target.closest('[onclick*="location.href"]');
        if (onclickTarget && !onclickTarget.classList.contains('no-loading')) {
          scheduleShowLoading();
        }
      });

      // 폼 제출 시 로딩 표시
      document.addEventListener('submit', function(e) {
        if (isLoading) return;
        const form = e.target;
        if (!form.classList.contains('no-loading') && !form.hasAttribute('data-no-loading')) {
          scheduleShowLoading();
        }
      });

      // 뒤로가기/앞으로가기 시 로딩 숨김
      window.addEventListener('pageshow', function(e) {
        hideLoading();
      });

      // 페이지 로드 완료 시 로딩 숨김 (안전장치)
      window.addEventListener('load', function() {
        hideLoading();
      });

      // visibility 변경 시 로딩 숨김 (탭 전환 등)
      document.addEventListener('visibilitychange', function() {
        if (document.visibilityState === 'visible') {
          hideLoading();
        }
      });

      // beforeunload 이벤트로 페이지 이동 감지 (보조)
      window.addEventListener('beforeunload', function() {
        showLoading();
      });
    })();
  </script>
</body>
</html>
